<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrenador de Tiempos Pasados - Espa√±ol</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary-color: #059669;
            --accent-color: #dc2626;
            --background-color: #f8fafc;
            --surface-color: #ffffff;
            --text-color: #1f2937;
            --text-light: #6b7280;
            --border-color: #e5e7eb;
            --success-color: #10b981;
            --error-color: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            --transition-fast: 0.15s ease-out;
            --transition-base: 0.3s ease-out;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            font-size: var(--font-size-base);
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .app {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .app-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: var(--spacing-sm) var(--spacing-sm);
            text-align: center;
            box-shadow: var(--shadow-md);
        }

        .app-header h1 {
            font-size: var(--font-size-lg);
            font-weight: 600;
            margin-bottom: 0;
        }

        .app-header .subtitle {
            display: none;
        }

        .app-main {
            flex: 1;
            padding: var(--spacing-md) var(--spacing-sm);
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-sm);
            flex-shrink: 0;
        }

        .card {
            background: var(--surface-color);
            border-radius: 6px;
            padding: var(--spacing-xs);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .card h3 {
            font-size: var(--font-size-sm);
            margin-bottom: var(--spacing-xs);
            font-weight: 600;
        }

        .exercise-container {
            background: var(--surface-color);
            border-radius: 12px;
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            max-width: 800px;
            margin: 0 auto;
            flex: 1;
            overflow-y: auto;
        }

        .exercise-header {
            margin-bottom: var(--spacing-md);
        }

        .exercise-type {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm);
        }

        .type-badge {
            background: var(--primary-color);
            color: white;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: 20px;
            font-size: var(--font-size-sm);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .difficulty {
            font-size: var(--font-size-sm);
            font-weight: 500;
        }

        .question-section {
            margin-bottom: var(--spacing-lg);
            text-align: center;
        }

        .question-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: var(--spacing-sm);
        }

        .question-text {
            font-size: var(--font-size-base);
            line-height: 1.6;
            color: var(--text-color);
            background: var(--background-color);
            padding: var(--spacing-md);
            border-radius: 8px;
            border: 2px solid var(--border-color);
            margin-bottom: var(--spacing-sm);
        }

        .options-section {
            display: grid;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .option-button {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--surface-color);
            cursor: pointer;
            transition: all var(--transition-base);
            font-size: var(--font-size-base);
            text-align: left;
        }

        .option-button:hover {
            border-color: var(--primary-color);
            background: #f8fafc;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .option-button.selected {
            border-color: var(--primary-color);
            background: #eff6ff;
        }

        .option-button.correct {
            border-color: var(--success-color);
            background: #f0fdf4;
            color: var(--success-color);
        }

        .option-button.incorrect {
            border-color: var(--error-color);
            background: #fef2f2;
            color: var(--error-color);
        }

        .option-letter {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            font-weight: 600;
            font-size: var(--font-size-sm);
            flex-shrink: 0;
        }

        .option-button.correct .option-letter {
            background: var(--success-color);
        }

        .option-button.incorrect .option-letter {
            background: var(--error-color);
        }

        .option-text {
            flex: 1;
            font-weight: 500;
        }

        .result-section {
            padding: var(--spacing-md);
            border-radius: 8px;
            margin-bottom: var(--spacing-md);
            display: flex;
            gap: var(--spacing-md);
            align-items: flex-start;
        }

        .result-section.correct {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 2px solid var(--success-color);
        }

        .result-section.incorrect {
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
            border: 2px solid var(--error-color);
        }

        .result-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .result-content {
            flex: 1;
        }

        .result-title {
            font-size: var(--font-size-lg);
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
        }

        .result-section.correct .result-title {
            color: var(--success-color);
        }

        .result-section.incorrect .result-title {
            color: var(--error-color);
        }

        .result-explanation {
            font-size: var(--font-size-sm);
            line-height: 1.5;
            margin-bottom: var(--spacing-sm);
        }

        .tip {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
            padding: var(--spacing-sm);
            border-left: 3px solid #f59e0b;
        }

        .tip-label {
            font-weight: 600;
            color: #92400e;
            margin-bottom: var(--spacing-xs);
            font-size: var(--font-size-sm);
        }

        .tip-text {
            color: #92400e;
            margin: 0;
            font-size: var(--font-size-sm);
        }

        .progress-stats {
            text-align: center;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: var(--font-size-lg);
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .streak-display {
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs);
        }

        .streak-number {
            font-size: var(--font-size-lg);
            font-weight: 700;
            color: var(--text-color);
        }

        .streak-label {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .app-footer {
            display: none;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            color: var(--text-light);
        }

        @media (max-width: 768px) {
            .app-header {
                padding: var(--spacing-xs) var(--spacing-sm);
            }

            .app-header h1 {
                font-size: var(--font-size-base);
            }

            .app-main {
                padding: var(--spacing-xs);
            }

            .dashboard {
                grid-template-columns: 1fr 1fr;
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-xs);
            }

            .card {
                padding: var(--spacing-xs);
            }

            .card h3 {
                font-size: 0.75rem;
                margin-bottom: 2px;
            }

            .stat-number {
                font-size: var(--font-size-base);
            }

            .stat-label {
                font-size: 0.6rem;
            }

            .streak-number {
                font-size: var(--font-size-base);
            }

            .streak-label {
                font-size: 0.6rem;
            }

            .exercise-container {
                padding: var(--spacing-sm);
            }

            .exercise-type {
                flex-direction: column;
                gap: var(--spacing-xs);
                align-items: flex-start;
            }

            .question-text {
                padding: var(--spacing-sm);
                font-size: var(--font-size-sm);
            }

            .option-button {
                padding: var(--spacing-sm);
                gap: var(--spacing-xs);
            }

            .result-section {
                flex-direction: column;
                gap: var(--spacing-sm);
                padding: var(--spacing-sm);
            }

            .result-icon {
                align-self: center;
                font-size: 1.25rem;
            }
        }

        .fade-in {
            animation: fade-in 0.3s ease-out;
        }

        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="app-header">
            <h1>Entrenador de Tiempos Pasados</h1>
            <p class="subtitle">Domina el pret√©rito e imperfecto en espa√±ol</p>
        </header>

        <main class="app-main">
            <div class="dashboard">
                <div class="card">
                    <h3>Progreso</h3>
                    <div class="progress-stats">
                        <div class="stat-item">
                            <div class="stat-number" id="correct-count">0</div>
                            <div class="stat-label">Correctas</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="total-count">0</div>
                            <div class="stat-label">Total</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Racha</h3>
                    <div class="streak-display">
                        <div class="streak-number" id="streak-count">0</div>
                        <div class="streak-label">d√≠as</div>
                    </div>
                </div>
            </div>

            <div class="exercise-container fade-in" id="exercise-container">
                <!-- Exercise content will be loaded here -->
            </div>
        </main>

        <footer class="app-footer">
            <p>üí° Practica 5-10 minutos diarios para mejores resultados</p>
        </footer>
    </div>

    <script>
        // Spanish past tense exercises data
        const exercises = [
            {
                id: "preterite_vs_imperfect_01",
                type: "Pret√©rito vs Imperfecto",
                difficulty: "easy",
                question: "Cuando era ni√±o, siempre _____ al parque los domingos.",
                options: ["fui", "iba", "ir√©", "voy"],
                correctAnswer: 1,
                explanation: "Se usa el imperfecto 'iba' porque describe una acci√≥n habitual en el pasado (siempre los domingos).",
                tip: "El imperfecto describe acciones repetidas o habituales en el pasado. Palabras clave: siempre, todos los d√≠as, cada vez."
            },
            {
                id: "preterite_vs_imperfect_02",
                type: "Pret√©rito vs Imperfecto",
                difficulty: "easy",
                question: "Ayer _____ a mi abuela por tel√©fono.",
                options: ["llamaba", "llam√©", "llamo", "llamar√©"],
                correctAnswer: 1,
                explanation: "Se usa el pret√©rito 'llam√©' porque es una acci√≥n espec√≠fica que ocurri√≥ ayer.",
                tip: "El pret√©rito se usa para acciones completadas en un momento espec√≠fico. Palabras clave: ayer, anoche, el lunes pasado."
            },
            {
                id: "preterite_vs_imperfect_03",
                type: "Pret√©rito vs Imperfecto",
                difficulty: "easy",
                question: "Mientras _____ la televisi√≥n, son√≥ el tel√©fono.",
                options: ["vi", "ve√≠a", "veo", "ver√©"],
                correctAnswer: 1,
                explanation: "Se usa el imperfecto 've√≠a' porque describe una acci√≥n en progreso que fue interrumpida.",
                tip: "Mientras + imperfecto describe una acci√≥n en progreso. El pret√©rito interrumpe esa acci√≥n."
            },
            {
                id: "preterite_vs_imperfect_04",
                type: "Pret√©rito vs Imperfecto",
                difficulty: "medium",
                question: "Los ni√±os _____ en el jard√≠n cuando empez√≥ a llover.",
                options: ["jugaron", "jugaban", "juegan", "jugar√°n"],
                correctAnswer: 1,
                explanation: "Se usa el imperfecto 'jugaban' porque describe una acci√≥n en progreso que fue interrumpida por la lluvia.",
                tip: "Acci√≥n en progreso (imperfecto) + interrupci√≥n (pret√©rito) es un patr√≥n muy com√∫n."
            },
            {
                id: "preterite_vs_imperfect_05",
                type: "Pret√©rito vs Imperfecto",
                difficulty: "medium",
                question: "Conoc√≠ a Mar√≠a cuando _____ en Madrid.",
                options: ["viv√≠", "viv√≠a", "vivo", "vivir√©"],
                correctAnswer: 1,
                explanation: "Se usa el imperfecto 'viv√≠a' porque describe las circunstancias (d√≥nde viv√≠a) cuando ocurri√≥ el evento (conocer a Mar√≠a).",
                tip: "El imperfecto establece el contexto o las circunstancias de una acci√≥n en pret√©rito."
            }
        ];

        // App state
        let currentExerciseIndex = 0;
        let currentExercise = null;
        let selectedAnswer = null;
        let showResult = false;
        let correctCount = 0;
        let totalCount = 0;
        let streak = 0;

        // Load saved progress
        function loadProgress() {
            const saved = localStorage.getItem('langlearn_progress');
            if (saved) {
                const data = JSON.parse(saved);
                correctCount = data.correct || 0;
                totalCount = data.total || 0;
                streak = data.streak || 0;
            }
            updateProgressDisplay();
        }

        // Save progress
        function saveProgress() {
            const data = {
                correct: correctCount,
                total: totalCount,
                streak: streak
            };
            localStorage.setItem('langlearn_progress', JSON.stringify(data));
        }

        // Update progress display
        function updateProgressDisplay() {
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('total-count').textContent = totalCount;
            document.getElementById('streak-count').textContent = streak;
        }

        // Shuffle array function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Get next exercise with shuffled options
        function getNextExercise() {
            const baseExercise = exercises[currentExerciseIndex % exercises.length];
            
            // Create array of options with their original indices
            const optionsWithIndices = baseExercise.options.map((option, index) => ({
                text: option,
                originalIndex: index
            }));
            
            // Shuffle the options
            const shuffledOptions = shuffleArray(optionsWithIndices);
            
            // Find where the correct answer ended up
            const newCorrectAnswer = shuffledOptions.findIndex(
                option => option.originalIndex === baseExercise.correctAnswer
            );
            
            // Return exercise with shuffled options
            return {
                ...baseExercise,
                options: shuffledOptions.map(option => option.text),
                correctAnswer: newCorrectAnswer
            };
        }

        // Render exercise
        function renderExercise(exercise) {
            const container = document.getElementById('exercise-container');
            
            const difficultyEmoji = {
                'easy': 'üü¢ F√°cil',
                'medium': 'üü° Intermedio',
                'hard': 'üî¥ Dif√≠cil'
            };

            container.innerHTML = `
                <div class="exercise-header">
                    <div class="exercise-type">
                        <span class="type-badge">${exercise.type}</span>
                        <span class="difficulty">${difficultyEmoji[exercise.difficulty]}</span>
                    </div>
                </div>

                <div class="question-section">
                    <h2 class="question-title">Completa la oraci√≥n:</h2>
                    <p class="question-text">${exercise.question}</p>
                </div>

                <div class="options-section" id="options-section">
                    ${exercise.options.map((option, index) => `
                        <button class="option-button" onclick="selectAnswer(${index})">
                            <span class="option-letter">${String.fromCharCode(65 + index)}</span>
                            <span class="option-text">${option}</span>
                        </button>
                    `).join('')}
                </div>

                <div id="result-section" style="display: none;"></div>
            `;
        }

        // Select answer
        function selectAnswer(optionIndex) {
            if (showResult) return;

            selectedAnswer = optionIndex;
            const isCorrect = optionIndex === currentExercise.correctAnswer;
            
            // Update stats
            totalCount++;
            if (isCorrect) {
                correctCount++;
                const today = new Date().toDateString();
                const lastCompleted = localStorage.getItem('langlearn_last_completed');
                if (lastCompleted !== today) {
                    streak++;
                    localStorage.setItem('langlearn_last_completed', today);
                }
            }
            
            saveProgress();
            updateProgressDisplay();
            showResult = true;

            // Update option styles
            const options = document.querySelectorAll('.option-button');
            options.forEach((button, index) => {
                if (index === currentExercise.correctAnswer) {
                    button.classList.add('correct');
                } else if (index === selectedAnswer && !isCorrect) {
                    button.classList.add('incorrect');
                }
                button.style.pointerEvents = 'none';
            });

            // Show result
            showExerciseResult(isCorrect);
        }

        // Show exercise result
        function showExerciseResult(isCorrect) {
            const resultSection = document.getElementById('result-section');
            resultSection.style.display = 'flex';
            resultSection.className = `result-section ${isCorrect ? 'correct' : 'incorrect'}`;
            
            resultSection.innerHTML = `
                <div class="result-icon">${isCorrect ? '‚úÖ' : '‚ùå'}</div>
                <div class="result-content">
                    <h3 class="result-title">${isCorrect ? '¬°Correcto!' : 'Incorrecto'}</h3>
                    <p class="result-explanation">${currentExercise.explanation}</p>
                    ${currentExercise.tip ? `
                        <div class="tip">
                            <p class="tip-label">üí° Consejo:</p>
                            <p class="tip-text">${currentExercise.tip}</p>
                        </div>
                    ` : ''}
                    <button onclick="nextExercise()" style="
                        margin-top: var(--spacing-md);
                        padding: var(--spacing-sm) var(--spacing-lg);
                        background: var(--primary-color);
                        color: white;
                        border: none;
                        border-radius: 6px;
                        cursor: pointer;
                        font-size: var(--font-size-base);
                        font-weight: 500;
                        transition: background var(--transition-base);
                    " onmouseover="this.style.background='var(--primary-dark)'" onmouseout="this.style.background='var(--primary-color)'">
                        Continuar ‚Üµ
                    </button>
                </div>
            `;
        }

        // Next exercise
        function nextExercise() {
            currentExerciseIndex++;
            currentExercise = getNextExercise();
            selectedAnswer = null;
            showResult = false;
            
            renderExercise(currentExercise);
            document.getElementById('exercise-container').classList.add('fade-in');
        }

        // Initialize app
        function initApp() {
            // Show loading first
            const container = document.getElementById('exercise-container');
            container.innerHTML = '<div class="loading"><p>Cargando ejercicio...</p></div>';
            
            // Small delay to show loading, then load exercise
            setTimeout(() => {
                loadProgress();
                currentExercise = getNextExercise();
                renderExercise(currentExercise);
            }, 100);
        }

        // Keyboard event handler
        function handleKeyPress(event) {
            // If showing results, allow Enter/Space to continue
            if (showResult && (event.code === 'Enter' || event.code === 'Space')) {
                event.preventDefault(); // Prevent default space scrolling
                nextExercise();
                return;
            }
            
            // If not showing results, allow A-D keys to select answers
            if (!showResult && currentExercise) {
                const key = event.key.toLowerCase();
                if (key >= 'a' && key <= 'd') {
                    event.preventDefault();
                    const optionIndex = key.charCodeAt(0) - 'a'.charCodeAt(0);
                    if (optionIndex < currentExercise.options.length) {
                        selectAnswer(optionIndex);
                    }
                }
            }
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', initApp);
        
        // Add keyboard event listeners
        document.addEventListener('keydown', handleKeyPress);
    </script>
</body>
</html>